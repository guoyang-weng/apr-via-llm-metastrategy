The root cause of the problem is that the if condition in the nested loop is not correct. The condition checks whether the set of ordered_nodes is a superset of nextnode.outgoing_nodes, which is not the appropriate condition for topological ordering. In topological ordering, we need to ensure that a node is only added to the ordered list when all its incoming nodes are already in the ordered list.